# Differential Expression Analysis of miRNAs in PSP-RS and PD Midbrain Organoids

## Project Overview

This project performs differential expression (DE) analysis on microRNA (miRNA) sequencing data derived from iPSC-based midbrain organoids modeling Progressive Supranuclear Palsy–Richardson Syndrome (PSP-RS), Parkinson's Disease (PD), and Healthy Controls (HCs).

The study aims to identify disease-specific miRNA signatures across multiple time points (60, 90, 120 days) to facilitate biomarker discovery and understand disease-specific regulatory networks.

## Disease Context

**Progressive Supranuclear Palsy–Richardson Syndrome (PSP-RS):**
A rare, rapidly progressive neurodegenerative tauopathy often misdiagnosed as PD due to overlapping clinical features. Reliable molecular biomarkers for early and differential diagnosis are lacking.

**Parkinson's Disease (PD):**
A common neurodegenerative disorder characterized by dopaminergic neuron loss and Lewy body formation.

**Reference Study:**
Valente D, Zannino C, Scalise S, Bressan D et al. Distinct microRNA signatures define sporadic PSP-RS and PD in patient-derived midbrain organoids. iScience 2025;28(8):113162. PMID: 40799390

**NCBI GEO Dataset:**
- Title: Distinct microRNA signatures define sporadic PSP-RS and PD in patient-derived midbrain organoids
- Organism: Homo sapiens
- Experiment Type: Non-coding RNA profiling by high throughput sequencing
- Sample Description: 27 samples (3 conditions × 3 time points × 3 replicates)
- Data Files Used: `*_RAW_count_tsv.gz` and `*_series_matrix.txt.gz`

## Folder Structure

```
run_seq_parkinson/
├── data/
│   ├── GSE294029_Raw_counts.tsv.gz
│   └── GSE294029_series_matrix.txt.gz
├── scripts/
│   ├── extract_counts.sh
│   └── deseq2.R
├── counts_matrix.tsv
├── coldata.csv
└── results/
    ├── DESeq2_<group1>_vs_<group2>.csv
    ├── DESeq2_significant_<group1>_vs_<group2>.csv
    ├── MAplot_<group1>_vs_<group2>.png
    ├── Volcano_<group1>_vs_<group2>.png
    └── PCA_plot.png
```

- `data/`: raw GEO dataset files
- `scripts/`: scripts for data extraction and DESeq2 analysis
- `counts_matrix.tsv`: combined raw counts matrix used for DESeq2
- `coldata.csv`: sample metadata (sample ID, condition, timepoint, replicate)
- `results/`: all DESeq2 output files and visualizations

## Data Preparation

### 1. Extracting Counts

The raw GEO counts were processed using a shell script:

```bash
bash scripts/extract_counts.sh
```

This generated the `counts_matrix.tsv` and `coldata.csv` file containing miRNAs as rows and samples as columns.

### 2. Metadata Preparation

The `coldata.csv` contains:

| sample_id   | condition | timepoint | replicate |
|-------------|-----------|-----------|-----------|
| HC_d60_r1   | HC        | 60        | 1         |
| PD_d120_r2  | PD        | 120       | 2         |
| ...         | ...       | ...       | ...       |

Used to define experimental groups for DESeq2. Combined condition and timepoint into a single factor group (e.g., PD_d120).

## Analysis Workflow

### 1. Setup

Load R libraries:

```r
library(DESeq2)
library(ggplot2)
library(EnhancedVolcano)
```

Define input files and results directory:

```r
counts_file  <- "counts_matrix.tsv"
coldata_file <- "coldata.csv"
results_dir  <- "E:/run_seq_parkinson/results/"
```

### 2. Data Loading & QC

Read counts and metadata:

```r
counts <- read.delim(counts_file, row.names=1, check.names=FALSE)
coldata <- read.csv(coldata_file, row.names=1, stringsAsFactors=FALSE)
```

Verify sample names match and combine condition + timepoint into group.

### 3. Differential Expression Analysis

Construct DESeq2 dataset:

```r
dds <- DESeqDataSetFromMatrix(
  countData = round(as.matrix(counts)),
  colData   = coldata,
  design    = ~ group
)
```

Run DESeq2:

```r
dds <- DESeq(dds)
```

Perform all pairwise contrasts between groups (e.g., PD_d120 vs HC_d120).

Extract results:
- All genes → `DESeq2_<group1>_vs_<group2>.csv`
- Significant genes (padj < 0.05) → `DESeq2_significant_<group1>_vs_<group2>.csv`

### 4. Visualization

- PCA plot to assess sample clustering: `PCA_plot.png`
- MA plots: `MAplot_<group1>_vs_<group2>.png`
- Volcano plots: `Volcano_<group1>_vs_<group2>.png`

### 5. Results

DESeq2 outputs saved in `results/`. 145 files generated, including CSV tables, MA plots, Volcano plots, PCA plot.

## How to Run

1. Place `counts_matrix.tsv` and `coldata.csv` in the working directory.
2. Run the DESeq2 script:

```bash
Rscript scripts/deseq2.R
```

All results will automatically be saved in `E:/run_seq_parkinson/results/`.

## Summary

This pipeline:

- Processes small RNA-seq counts from iPSC-derived midbrain organoids
- Performs differential expression analysis across multiple contrasts
- Generates visualizations (PCA, MA, Volcano plots)
- Produces CSV files for both all DE miRNAs and significant DE miRNAs

This allows downstream biomarker discovery and provides a reproducible workflow for miRNA analysis in neurodegenerative disease models.

## Contributors

Cuda G, Parrotta E, Valente D, Zannino C, Scalise S

## Citation

Valente D, Zannino C, Scalise S, Bressan D et al. Distinct microRNA signatures define sporadic PSP-RS and PD in patient-derived midbrain organoids. iScience 2025 Aug 15;28(8):113162. PMID: 40799390